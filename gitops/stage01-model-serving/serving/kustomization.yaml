---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Model Serving Application
# Deployed in: private-ai-demo namespace
# Purpose: MLOps pipeline, model serving, workbench

namespace: private-ai-demo

# Minimal labels for ArgoCD resource tracking (avoid conflicts with app-level labels)
commonLabels:
  argocd.argoproj.io/instance: stage01-model-serving

# Annotations for additional metadata
commonAnnotations:
  app.kubernetes.io/managed-by: argocd

# Resources in deployment order
resources:
  # Wave 0: Namespace infrastructure
  - project-namespace
  
  # Wave 1: Infrastructure
  - network-policy              # NetworkPolicy for Model Registry access
  - imagestreams                # ImageStreams for ModelCar images
  - workspaces                  # PVCs for pipeline workspace
  - model-registry              # Model Registry ConfigMap (used by pipelines)
  
  # Wave 2: MLOps Pipeline
  - pipelines                   # Tekton pipelines and tasks
  
  # Wave 3: Model Serving
  - vllm                        # InferenceServices and ServingRuntimes
  
  # Wave 4: Development Tools
  - model-serving-testing       # Interactive notebooks for testing
