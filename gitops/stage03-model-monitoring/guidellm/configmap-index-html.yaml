---
apiVersion: v1
kind: ConfigMap
metadata:
  name: guidellm-index-html
  namespace: private-ai-demo
  labels:
    app: guidellm-reports
data:
  index.html: |
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>GuideLLM Benchmark Reports - Private AI Demo</title>
        <link rel="stylesheet" href="https://unpkg.com/@patternfly/patternfly@5/patternfly.css">
        <style>
            body {
                font-family: 'Red Hat Text', 'Overpass', 'Open Sans', 'Helvetica Neue', Arial, sans-serif;
            }
            .pf-v5-c-page__header {
                background-color: #0066cc;
                color: white;
            }
            .report-card {
                margin: 1rem 0;
                padding: 1rem;
                border: 1px solid #d2d2d2;
                border-radius: 4px;
            }
            .report-card:hover {
                box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            }
            .badge {
                display: inline-block;
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
                font-weight: 600;
                border-radius: 3px;
                margin-right: 0.5rem;
            }
            .badge-daily { background-color: #e7f1fa; color: #004080; }
            .badge-weekly { background-color: #f3e6f9; color: #5a1e7d; }
            .badge-manual { background-color: #fef0e6; color: #a84001; }
            .loading {
                text-align: center;
                padding: 2rem;
            }
        </style>
    </head>
    <body>
        <div class="pf-v5-c-page">
            <header class="pf-v5-c-page__header">
                <div class="pf-v5-c-page__header-brand">
                    <h1 class="pf-v5-c-title pf-m-2xl" style="color: white;">
                        ðŸš€ GuideLLM Benchmark Reports
                    </h1>
                    <p style="color: #e0e0e0; margin-top: 0.5rem;">
                        Private AI Demo - LLM Inference Performance Benchmarks
                    </p>
                </div>
            </header>
            
            <main class="pf-v5-c-page__main">
                <section class="pf-v5-c-page__main-section pf-m-light">
                    <div class="pf-v5-l-grid pf-m-gutter">
                        <div class="pf-v5-l-grid__item pf-m-8-col">
                            <h2 class="pf-v5-c-title pf-m-lg">Available Reports</h2>
                            <p>
                                Click on any report below to view detailed benchmark results with interactive charts.
                                Reports are generated using <a href="https://github.com/vllm-project/guidellm" target="_blank">GuideLLM</a>.
                            </p>
                        </div>
                        <div class="pf-v5-l-grid__item pf-m-4-col" style="text-align: right;">
                            <button class="pf-v5-c-button pf-m-primary" onclick="refreshReports()">
                                Refresh List
                            </button>
                        </div>
                    </div>
                    
                    <div id="loading" class="loading">
                        <div class="pf-v5-c-spinner" role="progressbar">
                            <span class="pf-v5-c-spinner__clipper"></span>
                            <span class="pf-v5-c-spinner__lead-ball"></span>
                            <span class="pf-v5-c-spinner__tail-ball"></span>
                        </div>
                        <p>Loading benchmark reports...</p>
                    </div>
                    
                    <div id="report-list" class="pf-v5-l-stack pf-m-gutter" style="display: none;">
                        <!-- Populated by JavaScript -->
                    </div>
                    
                    <div id="no-reports" style="display: none; text-align: center; padding: 3rem;">
                        <p class="pf-v5-c-title pf-m-lg">No benchmark reports found</p>
                        <p>Run a benchmark to generate reports.</p>
                        <pre style="text-align: left; max-width: 600px; margin: 1rem auto; background: #f5f5f5; padding: 1rem; border-radius: 4px;">
    # Run manual benchmark
    oc create job guidellm-test-TIMESTAMP \
      --from=job/guidellm-benchmark-mistral-quantized \
      -n private-ai-demo</pre>
                    </div>
                </section>
                
                <section class="pf-v5-c-page__main-section">
                    <h3 class="pf-v5-c-title pf-m-md">About GuideLLM</h3>
                    <p>
                        GuideLLM is a tool for evaluating and enhancing LLM deployments for real-world inference needs.
                        It measures key performance metrics including latency, throughput, and resource utilization.
                    </p>
                    <ul>
                        <li><strong>Latency</strong>: Time to First Token (TTFT), Time per Output Token (TPOT)</li>
                        <li><strong>Throughput</strong>: Requests per second, Tokens per second</li>
                        <li><strong>Load Testing</strong>: Sweep, Constant, Poisson, Concurrent modes</li>
                    </ul>
                    <p>
                        <a href="https://github.com/vllm-project/guidellm" target="_blank" class="pf-v5-c-button pf-m-link">
                            View GuideLLM Documentation â†’
                        </a>
                    </p>
                </section>
            </main>
        </div>
        
        <script>
            function categorizeReport(filename) {
                if (filename.includes('daily')) return 'daily';
                if (filename.includes('weekly')) return 'weekly';
                return 'manual';
            }
            
            function formatDate(filename) {
                // Extract date from filename (e.g., mistral-quantized-20241110-143022.html)
                const match = filename.match(/(\d{8})-(\d{6})/);
                if (match) {
                    const date = match[1];
                    const time = match[2];
                    return `${date.substr(0,4)}-${date.substr(4,2)}-${date.substr(6,2)} ${time.substr(0,2)}:${time.substr(2,2)}`;
                }
                return 'Unknown';
            }
            
            function loadReports() {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('report-list').style.display = 'none';
                document.getElementById('no-reports').style.display = 'none';
                
                fetch('/reports/')
                    .then(res => res.text())
                    .then(html => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        const links = Array.from(doc.querySelectorAll('a[href$=".html"]'))
                            .filter(link => !link.getAttribute('href').includes('index.html'));
                        
                        const reportList = document.getElementById('report-list');
                        reportList.innerHTML = '';
                        
                        if (links.length === 0) {
                            document.getElementById('loading').style.display = 'none';
                            document.getElementById('no-reports').style.display = 'block';
                            return;
                        }
                        
                        links.forEach(link => {
                            const filename = link.textContent;
                            const category = categorizeReport(filename);
                            const date = formatDate(filename);
                            
                            const model = filename.includes('quantized') ? 'Mistral 24B Quantized' : 'Mistral 24B Full';
                            
                            const card = document.createElement('div');
                            card.className = 'report-card';
                            card.innerHTML = `
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 class="pf-v5-c-title pf-m-md" style="margin: 0;">
                                            <a href="/reports/${link.getAttribute('href')}" target="_blank" style="text-decoration: none; color: #0066cc;">
                                                ${model}
                                            </a>
                                        </h3>
                                        <p style="margin: 0.5rem 0; color: #6a6e73;">
                                            <span class="badge badge-${category}">${category.toUpperCase()}</span>
                                            ${date}
                                        </p>
                                    </div>
                                    <div>
                                        <a href="/reports/${link.getAttribute('href')}" target="_blank" class="pf-v5-c-button pf-m-primary">
                                            View Report
                                        </a>
                                    </div>
                                </div>
                            `;
                            reportList.appendChild(card);
                        });
                        
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('report-list').style.display = 'block';
                    })
                    .catch(err => {
                        console.error('Error loading reports:', err);
                        document.getElementById('loading').innerHTML = `
                            <p style="color: #c9190b;">Failed to load reports. Please check if the server is running.</p>
                        `;
                    });
            }
            
            function refreshReports() {
                loadReports();
            }
            
            // Load reports on page load
            window.addEventListener('DOMContentLoaded', loadReports);
            
            // Auto-refresh every 5 minutes
            setInterval(loadReports, 300000);
        </script>
    </body>
    </html>

