---
# ServiceAccount in private-ai-demo for accessing ai-infrastructure services
apiVersion: v1
kind: ServiceAccount
metadata:
  name: rag-workload-sa
  namespace: private-ai-demo
  labels:
    app: llama-stack
    component: rbac

---
# Role in ai-infrastructure to allow access to services
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: shared-services-access
  namespace: ai-infrastructure
  labels:
    app: shared-infrastructure
    component: rbac
rules:
  - apiGroups: [""]
    resources: ["services"]
    verbs: ["get", "list"]
    resourceNames:
      - "milvus-standalone"
      - "docling-service"
  - apiGroups: [""]
    resources: ["services/proxy"]
    verbs: ["get"]

---
# RoleBinding to grant private-ai-demo SA access to ai-infrastructure
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: rag-workload-shared-services
  namespace: ai-infrastructure
  labels:
    app: shared-infrastructure
    component: rbac
subjects:
  - kind: ServiceAccount
    name: rag-workload-sa
    namespace: private-ai-demo
  - kind: ServiceAccount
    name: default
    namespace: private-ai-demo
roleRef:
  kind: Role
  name: shared-services-access
  apiGroup: rbac.authorization.k8s.io


