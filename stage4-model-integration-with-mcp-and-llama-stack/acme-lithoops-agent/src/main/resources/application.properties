# ACME LithoOps Agent - Application Configuration
# Version: 2.0 (Llama Stack Orchestration)

# ═══════════════════════════════════════════════════════════════════════════
# APPLICATION SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

# Application name and version
quarkus.application.name=acme-lithoops-agent
quarkus.application.version=2.0.0

# HTTP Server
quarkus.http.port=8080
quarkus.http.host=0.0.0.0

# Logging
quarkus.log.level=INFO
quarkus.log.category."com.redhat.acme".level=DEBUG
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.console.color=true

# ═══════════════════════════════════════════════════════════════════════════
# LLAMA STACK INTEGRATION (Central Orchestrator)
# ═══════════════════════════════════════════════════════════════════════════

# Llama Stack Agent API
# This is the central orchestrator that handles:
# - Multi-model inference routing
# - MCP tool selection and execution
# - RAG integration
# - Agent conversation management
quarkus.rest-client.llama-stack.url=http://llamastack-server.private-ai-demo.svc.cluster.local:8321
quarkus.rest-client.llama-stack.scope=jakarta.inject.Singleton

# Connection timeouts (agent calls can take time due to tool execution)
quarkus.rest-client.llama-stack.connect-timeout=30000
quarkus.rest-client.llama-stack.read-timeout=120000

# ═══════════════════════════════════════════════════════════════════════════
# AGENT CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════

# Agent ID (must match registration in Llama Stack)
acme.agent.id=acme-calibration-agent

# Enable/disable tool usage (for testing)
acme.agent.enable-tools=true

# ═══════════════════════════════════════════════════════════════════════════
# FAULT TOLERANCE
# ═══════════════════════════════════════════════════════════════════════════

# Retry configuration for Llama Stack calls
# (Agent calls may timeout if tools are slow or model is busy)
quarkus.fault-tolerance.retry.max-retries=2
quarkus.fault-tolerance.retry.delay=2s
quarkus.fault-tolerance.timeout.value=2m

# Circuit breaker for agent service
quarkus.fault-tolerance.circuit-breaker.failure-threshold=5
quarkus.fault-tolerance.circuit-breaker.delay=30s

# ═══════════════════════════════════════════════════════════════════════════
# HEALTH & METRICS
# ═══════════════════════════════════════════════════════════════════════════

# Health checks
quarkus.smallrye-health.root-path=/q/health
quarkus.smallrye-health.liveness-path=/q/health/live
quarkus.smallrye-health.readiness-path=/q/health/ready

# Include REST client health checks
quarkus.smallrye-health.extensions.enabled=true

# Metrics
quarkus.micrometer.enabled=true
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/q/metrics

# ═══════════════════════════════════════════════════════════════════════════
# DEVELOPMENT MODE SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

%dev.quarkus.log.category."com.redhat.acme".level=DEBUG
%dev.quarkus.rest-client.llama-stack.url=http://localhost:8321
%dev.quarkus.http.port=8080

# ═══════════════════════════════════════════════════════════════════════════
# PRODUCTION SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

%prod.quarkus.log.level=INFO
%prod.quarkus.log.category."com.redhat.acme".level=INFO

# ═══════════════════════════════════════════════════════════════════════════
# NOTES ON ARCHITECTURE CHANGES
# ═══════════════════════════════════════════════════════════════════════════
#
# Version 2.0 - Llama Stack Orchestration (Current)
# --------------------------------------------------
# • Llama Stack handles ALL orchestration
# • Native MCP integration (no custom clients needed)
# • Multi-model support (quantized + full)
# • Built-in RAG with Milvus
# • Thin Quarkus application (REST API only)
#
# Version 1.0 - Custom Orchestration (Deprecated)
# ------------------------------------------------
# • Custom Quarkus + LangChain4j orchestration
# • Manual MCP client implementations
# • Single model (Mistral quantized only)
# • No native RAG integration
# • ~1500 lines of orchestration code
#
# Migration Notes:
# ----------------
# • Agent must be registered in Llama Stack before deployment
# • MCP servers must expose SSE endpoints at /sse
# • Session IDs are generated per-request for stateless operation
# • Tool calls are logged but not exposed in API response
#
