apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component

metadata:
  name: gpu-provisioning
  annotations:
    config.kubernetes.io/local-config: "true"

resources:
  # MachineConfigPool for GPU nodes
  - machineconfig-pool-gpu.yaml
  
  # MachineConfigs for GPU node OS configuration
  - machineconfig-gpu-base.yaml
  - machineconfig-g6-4xlarge.yaml
  - machineconfig-g6-12xlarge.yaml
  
  # GPU MachineSets - requires envsubst before applying
  # These files contain templates that need cluster-specific values
  # Note: MachineSets should be applied AFTER MachineConfigs
  # See README.md for deployment instructions
  - g6-4xlarge.yaml
  - g6-12xlarge.yaml

# Deployment Order:
# 1. Apply MachineConfigPool and MachineConfigs first
# 2. Wait for MachineConfigPool to be ready
# 3. Apply MachineSets with envsubst
# 4. Wait for nodes to provision and join cluster
#
# Note: This is a Component, not a Kustomization
# Components are composable and can be selectively included in overlays
