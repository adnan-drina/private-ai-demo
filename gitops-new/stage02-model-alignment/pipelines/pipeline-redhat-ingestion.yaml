apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: redhat-document-ingestion
  namespace: private-ai-demo
spec:
  workspaces:
  - name: documents

  tasks:
  # Task 1: Process Red Hat document with Docling
  - name: process-redhat-document
    taskRef:
      name: docling-process-pure-async
    workspaces:
    - name: documents
      workspace: documents
    params:
    - name: scenario
      value: "redhat"

  # Task 2: Chunk documents
  - name: chunk-redhat-documents
    runAfter: ["process-redhat-document"]
    taskRef:
      name: chunk-documents
    workspaces:
    - name: documents
      workspace: documents
    params:
    - name: scenario
      value: "redhat"

  # Task 3: Ingest to Milvus
  - name: ingest-redhat-to-milvus
    runAfter: ["chunk-redhat-documents"]
    taskRef:
      name: ingest-to-milvus
    workspaces:
    - name: documents
      workspace: documents
    params:
    - name: scenario
      value: "redhat"
